---
title: Exportieren, konfigurieren und Anzeigen von Überwachungsprotokolleinträgen
ms.author: markjjo
author: markjjo
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection:
- Strat_O365_IP
- M365-security-compliance
search.appverid:
- MOE150
- MET150
ms.assetid: 0d4d0f35-390b-4518-800e-0c7ec95e946c
description: Nachdem Sie die Ergebnisse einer Office 365-Überwachungsprotokoll Suche in eine CSV-Datei exportiert und heruntergeladen haben, können Sie das JSON-Transformations Feature im Power Query-Editor in Excel verwenden, um die einzelnen Eigenschaften im JSON-Objekt in der Auditdata-Spalte in eine eigene Spalte aufzuteilen. Auf diese Weise können Sie schnell die spezifischen Überwachungsdaten Auffinden, nach denen Sie suchen.
ms.openlocfilehash: 7dac373e8f25ead38dddbe2663e521b35b3153ef
ms.sourcegitcommit: b262d40f6daf06be26e7586f37b736e09f8a4511
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/02/2019
ms.locfileid: "35462912"
---
# <a name="export-configure-and-view-audit-log-records"></a><span data-ttu-id="c9e1a-104">Exportieren, konfigurieren und Anzeigen von Überwachungsprotokolleinträgen</span><span class="sxs-lookup"><span data-stu-id="c9e1a-104">Export, configure, and view audit log records</span></span>

<span data-ttu-id="c9e1a-105">Nachdem Sie das Office 365 Überwachungsprotokoll durchsucht und die Suchergebnisse in eine CSV-Datei heruntergeladen haben, enthält die Datei eine Spalte mit dem Namen **Auditdata**, die zusätzliche Informationen zu den einzelnen Ereignissen enthält.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-105">After you search the Office 365 audit log and download the search results to a CSV file, the file contains a column named **AuditData**, which contains additional information about each event.</span></span> <span data-ttu-id="c9e1a-106">Die Daten in dieser Spalte werden als JSON-Objekt formatiert, das mehrere Eigenschaften enthält, die als *Eigenschaft: Wert-* Paare durch Kommas getrennt konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-106">The data in this column is formatted as a JSON object, which contains multiple properties that are configured as *property:value* pairs separated by commas.</span></span> <span data-ttu-id="c9e1a-107">Sie können das JSON-Transformations Feature im Power Query-Editor in Excel verwenden, um jede Eigenschaft im JSON-Objekt in der **Auditdata** -Spalte in mehrere Spalten aufzuteilen, sodass jede Eigenschaft eine eigene Spalte aufweist.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-107">You can use the JSON transform feature in the Power Query Editor in Excel to split each property in the JSON object in the **AuditData** column into multiple columns so that each property has its own column.</span></span> <span data-ttu-id="c9e1a-108">Auf diese Weise können Sie eine oder mehrere dieser Eigenschaften sortieren und Filtern, die Ihnen helfen, die gewünschten Überwachungsdaten schnell zu finden.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-108">This lets you sort and filter on one or more of these properties, which can help you quickly locate the specific auditing data you're looking for.</span></span>

## <a name="step-1-export-audit-log-search-results"></a><span data-ttu-id="c9e1a-109">Schritt 1: Exportieren von Überwachungsprotokoll-Suchergebnissen</span><span class="sxs-lookup"><span data-stu-id="c9e1a-109">Step 1: Export audit log search results</span></span>

<span data-ttu-id="c9e1a-110">Der erste Schritt besteht darin, das Überwachungsprotokoll zu durchsuchen und die Ergebnisse dann in einer CSV-Datei (Comma-Separated Value) auf Ihren lokalen Computer zu exportieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-110">The first step is to search the audit log and then export the results in a comma-separated value (CSV) file to your local computer.</span></span>
  
1. <span data-ttu-id="c9e1a-111">Führen Sie eine [Überwachungsprotokoll Suche](search-the-audit-log-in-security-and-compliance.md#search-the-audit-log) aus, und überprüfen Sie bei Bedarf die Suchkriterien, bis Sie die gewünschten Ergebnisse haben.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-111">Run an [audit log search](search-the-audit-log-in-security-and-compliance.md#search-the-audit-log) and revise the search criteria if necessary until you have the desired results.</span></span>
    
2. <span data-ttu-id="c9e1a-112">Klicken Sie auf **Ergebnisse exportieren** , und wählen Sie **alle Ergebnisse herunterladen**aus.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-112">Click **Export results** and select **Download all results**.</span></span> 
    
   ![Klicken Sie auf alle Ergebnisse herunterladen.](media/ExportAuditSearchResults.png)

   <span data-ttu-id="c9e1a-114">Diese Option zum Exportieren aller Überwachungsdatensätze aus der Überwachungsprotokoll Suche, die Sie in Schritt 1 ausgeführt haben, und zum Herunterladen der Rohdaten aus dem Überwachungsprotokoll in eine CSV-Datei.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-114">This option to exports all the audit records from the audit log search you ran in step 1, and downloads the raw data from the audit log to a CSV file.</span></span> 

   <span data-ttu-id="c9e1a-115">Unten im Fenster wird eine Meldung angezeigt, in der Sie aufgefordert werden, die CSV-Datei zu öffnen oder zu speichern.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-115">A message is displayed at the bottom of the window that prompts you to open or save the CSV file.</span></span> 

3. <span data-ttu-id="c9e1a-116">Klicken Sie auf **speichern #a0** speichern unter, und speichern Sie die CSV-Datei auf Ihrem lokalen Computer.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-116">Click **Save > Save as** and save the CSV file to your local computer.</span></span> <span data-ttu-id="c9e1a-117">Es dauert eine Weile, bis viele Suchergebnisse heruntergeladen wurden.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-117">It takes a while to download many search results.</span></span> <span data-ttu-id="c9e1a-118">Dies ist normalerweise der Fall, wenn Sie nach allen Aktivitäten oder einem breiten Datumsbereich suchen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-118">This is typically the case when searching for all activities or a broad date range.</span></span> <span data-ttu-id="c9e1a-119">Eine Meldung unten im Fenster wird angezeigt, wenn die CSV-Datei heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-119">A message at the bottom of the windows is displayed when the CSV file is finished downloading.</span></span>
 
   ![Meldung, die angezeigt wird, wenn die CSV-Datei heruntergeladen wird](media/ExportAuditSearchResultsFinish.png)

> [!NOTE]
  > <span data-ttu-id="c9e1a-121">Sie können maximal 50.000 Einträge aus einer einzigen Überwachungsprotokoll Suche in eine CSV-Datei herunterladen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-121">You can download a maximum of 50,000 entries to a CSV file from a single audit log search.</span></span> <span data-ttu-id="c9e1a-122">Wenn 50.000-Einträge in die CSV-Datei heruntergeladen werden, können Sie wahrscheinlich davon ausgehen, dass es mehr als 50.000 Ereignisse gibt, die die Suchkriterien erfüllt haben.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-122">If 50,000 entries are downloaded to the CSV file, you can probably assume there are more than 50,000 events that met the search criteria.</span></span> <span data-ttu-id="c9e1a-123">Um mehr als diesen Grenzwert zu exportieren, verwenden Sie einen Datumsbereich, um die Anzahl der Überwachungsprotokolleinträge zu verringern.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-123">To export more than this limit, try using a date range to reduce the number of audit log records.</span></span> <span data-ttu-id="c9e1a-124">Möglicherweise müssen Sie mehrere Suchvorgänge mit kleineren Datumsbereichen ausführen, um mehr als 50.000 Einträge zu exportieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-124">You might have to run multiple searches with smaller date ranges to export more than 50,000 entries.</span></span>

## <a name="step-2-format-the-exported-audit-log-using-the-power-query-editor"></a><span data-ttu-id="c9e1a-125">Schritt 2: Formatieren des exportierten Überwachungsprotokolls mit dem Power Query-Editor</span><span class="sxs-lookup"><span data-stu-id="c9e1a-125">Step 2: Format the exported audit log using the Power Query Editor</span></span>

<span data-ttu-id="c9e1a-126">Im nächsten Schritt wird das JSON-Transformations Feature im Power Query-Editor in Excel verwendet, um die einzelnen Eigenschaften im JSON-Objekt in der **Auditdata** -Spalte in eine eigene Spalte aufzuteilen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-126">The next step is to use the JSON transform feature in the Power Query Editor in Excel to split each property in the JSON object in the **AuditData** column into its own column.</span></span> <span data-ttu-id="c9e1a-127">Anschließend Filtern Sie Spalten, um Datensätze basierend auf den Werten bestimmter Eigenschaften anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-127">Then you filter columns to view records based on the values of specific properties.</span></span> <span data-ttu-id="c9e1a-128">Auf diese Weise können Sie schnell die spezifischen Überwachungsdaten Auffinden, nach denen Sie suchen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-128">This can help you quickly locate the specific auditing data you're looking for.</span></span>

1. <span data-ttu-id="c9e1a-129">Öffnen Sie eine leere Arbeitsmappe in Excel für Office 365, Excel 2019 oder Excel 2016.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-129">Open a blank workbook in Excel for Office 365, Excel 2019, or Excel 2016.</span></span>
    
2.  <span data-ttu-id="c9e1a-130">Klicken Sie auf der Registerkarte **Daten** in der Gruppe **#a0 Transformationsdaten abrufen** auf **von Text/CSV**.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-130">On the **Data** tab, in the **Get & Transform Data** ribbon group, click **From Text/CSV**.</span></span>

    ![Klicken Sie auf der Registerkarte Daten auf aus Text/CSV.](media/JSONTransformOpenCSVFile.png)

3. <span data-ttu-id="c9e1a-132">Öffnen Sie die CSV-Datei, die Sie in Schritt 1 heruntergeladen haben.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-132">Open the CSV file that you downloaded in Step 1.</span></span>
    
4. <span data-ttu-id="c9e1a-133">Klicken Sie im angezeigten Fenster auf **Daten**transformieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-133">In the window that's displayed, click **Transform Data**.</span></span>

   ![Klicken Sie auf Daten transformieren](media/JSONOpenPowerQuery.png)

<span data-ttu-id="c9e1a-135">Die CSV-Datei wird im **Abfrage-Editor**geöffnet.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-135">The CSV file is opened in the **Query Editor**.</span></span> <span data-ttu-id="c9e1a-136">Es gibt vier Spalten: **CreationDate**, **userids**, **Operations**und **Auditdata**.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-136">There are four columns: **CreationDate**, **UserIds**, **Operations**, and **AuditData**.</span></span> <span data-ttu-id="c9e1a-137">Die **Auditdata** -Spalte ist ein JSON-Objekt, das mehrere Eigenschaften enthält.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-137">The **AuditData** column is a JSON object that contains multiple properties.</span></span> <span data-ttu-id="c9e1a-138">Im nächsten Schritt erstellen Sie eine Spalte für jede Eigenschaft im JSON-Objekt.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-138">The next step is to create a column for each property in the JSON object.</span></span>
    
5. <span data-ttu-id="c9e1a-139">Klicken Sie mit der rechten Maustaste auf den Titel in der Spalte **Auditdata** , klicken Sie auf Transformieren, und klicken Sie dann auf **JSON**. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="c9e1a-139">Right-click the title in the **AuditData** column, click **Transform**, and then click **JSON**.</span></span> 
 
   ![Klicken Sie mit der rechten Maustaste auf die Spalte Auditdata, klicken Sie auf Transformation, und wählen Sie dann JSON aus.](media/JSONTransform.png)

6. <span data-ttu-id="c9e1a-141">Klicken Sie in der oberen rechten Ecke der Spalte **Auditdata** auf das Symbol erweitern.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-141">In the upper-right corner of the **AuditData** column, click the expand icon.</span></span>
    
   ![Klicken Sie in der Spalte Auditdata auf das Erweiterungssymbol](media/JSONTransformExpandIcon.png)

   <span data-ttu-id="c9e1a-143">Eine unvollständige Liste der Eigenschaften in den JSON-Objekten in der **Auditdata** -Spalte wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-143">A partial list of the properties in the JSON objects in the **AuditData** column is displayed.</span></span>

7. <span data-ttu-id="c9e1a-144">Klicken Sie auf **mehr laden** , um alle Eigenschaften in den JSON-Objekten in der **Auditdata** -Spalte anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-144">Click **Load more** to display all properties in the JSON objects in the **AuditData** column.</span></span>

   ![Klicken Sie auf mehr laden, um alle Eigenschaften im JSON-Objekt anzuzeigen.](media/JSONTransformLoadJSONProperties.png)

   <span data-ttu-id="c9e1a-146">Sie können das Kontrollkästchen neben einer Eigenschaft, die Sie nicht einschließen möchten, aufheben.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-146">You can unselect the checkbox next to any property that you don't want to include.</span></span> <span data-ttu-id="c9e1a-147">Das Ausschließen von Spalten, die für Ihre Untersuchung nicht hilfreich sind, ist eine gute Möglichkeit, die im Überwachungsprotokoll angezeigte Datenmenge zu reduzieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-147">Eliminating columns that aren't useful for your investigation is a good way to reduce the amount of data displayed in the audit log.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="c9e1a-148">Die im vorherigen Screenshot angezeigten JSON-Eigenschaften (nachdem Sie auf **mehr laden**klicken) basieren auf den Eigenschaften, die in der **Auditdata** -Spalte aus den ersten 1.000-Zeilen in der CSV-Datei gefunden wurden.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-148">The JSON properties displayed in the previous screenshot (after you click **Load more**) are based on the properties found in the **AuditData** column from the first 1,000 rows in the CSV file.</span></span> <span data-ttu-id="c9e1a-149">Wenn in Datensätzen nach den ersten 1.000-Zeilen unterschiedliche JSON-Eigenschaften vorhanden sind, werden diese Eigenschaften (und eine entsprechende Spalte) nicht berücksichtigt, wenn die **Auditdata** -Spalte in mehrere Spalten aufgeteilt wird.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-149">If there are different JSON properties in records after the first 1,000 rows, these properties (and a corresponding column) won't be included when the **AuditData** column is split into multiple columns.</span></span> <span data-ttu-id="c9e1a-150">Um dies zu verhindern, sollten Sie die Überwachungsprotokoll Suche erneut durchführen und die Suchkriterien eingrenzen, sodass weniger Datensätze zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-150">To help prevent this, consider re-running the audit log search and narrow the search criteria so that fewer records are returned.</span></span> <span data-ttu-id="c9e1a-151">Eine weitere Problemumgehung besteht darin, Elemente in der Spalte **Vorgänge** zu filtern, um die Anzahl der Zeilen (vor dem Ausführen von Schritt 5 oben) zu reduzieren, bevor das JSON-Objekt in der **Auditdata** -Spalte transformiert wird.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-151">Another workaround is to filter items in the **Operations** column to reduce the number of rows (before you perform step 5 above) before transforming the JSON object in the **AuditData** column.</span></span>

8. <span data-ttu-id="c9e1a-152">Führen Sie eine der folgenden Aktionen aus, um den Titel der Spalten zu formatieren, die für jede ausgewählte JSON-Eigenschaft hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-152">Do one of the following things to format the title of the columns that are added for each JSON property that's selected.</span></span>

    - <span data-ttu-id="c9e1a-153">Deaktivieren Sie das Kontrollkästchen **ursprünglichen Spaltennamen als Präfix verwenden** , um den Namen der JSON-Eigenschaft als Spaltennamen zu verwenden. beispielsweise **RecordType** oder **sourceFileName**.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-153">Unselect the **Use original column name as prefix** checkbox to use the name of the JSON property as the column names; for example, **RecordType** or **SourceFileName**.</span></span>
    
   - <span data-ttu-id="c9e1a-154">Lassen Sie das Kontrollkästchen **ursprünglichen Spaltennamen als Präfix verwenden** aktiviert, um dem Spaltennamen das Auditdata-Präfix hinzuzufügen. Beispiel: **Auditdata. RecordType** oder **Auditdata. sourceFileName**.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-154">Leave the **Use original column name as prefix** checkbox selected to add the AuditData prefix to the column names; for example, **AuditData.RecordType** or **AuditData.SourceFileName**.</span></span>

9. <span data-ttu-id="c9e1a-155">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-155">Click **OK**.</span></span>
    
    <span data-ttu-id="c9e1a-156">Die **Auditdata** -Spalte wird in mehrere Spalten aufgeteilt.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-156">The **AuditData** column is split into multiple columns.</span></span> <span data-ttu-id="c9e1a-157">Jede neue Spalte entspricht einer Eigenschaft im JSON-Objekt Auditdata.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-157">Each new column corresponds to a property in the AuditData JSON object.</span></span> <span data-ttu-id="c9e1a-158">Jede Zeile in der Spalte enthält den Wert für die Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-158">Each row in the column contains the value for the property.</span></span> <span data-ttu-id="c9e1a-159">Wenn die Eigenschaft keinen Wert enthält, wird der *null* -Wert angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-159">If the property doesn't contain a value, the *null* value is displayed.</span></span> <span data-ttu-id="c9e1a-160">In Excel sind Zellen mit NULL-Werten leer.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-160">In Excel, cells with null values are empty.</span></span>
  
10. <span data-ttu-id="c9e1a-161">Klicken Sie auf der Registerkarte **Start** auf **#a0 Laden schließen** , um den Power Query-Editor zu schließen und die transformierte CSV-Datei in einer Excel-Arbeitsmappe zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-161">On the **Home** tab, click **Close & Load** to close the Power Query Editor and open the transformed CSV file in an Excel workbook.</span></span> 

## <a name="tips-for-exporting-and-viewing-the-audit-log"></a><span data-ttu-id="c9e1a-162">Tipps zum Exportieren und Anzeigen des Überwachungsprotokolls</span><span class="sxs-lookup"><span data-stu-id="c9e1a-162">Tips for exporting and viewing the audit log</span></span>

<span data-ttu-id="c9e1a-163">Im folgenden finden Sie einige Tipps und Beispiele für das Exportieren und Anzeigen des Überwachungsprotokolls vor und nach dem Verwenden des JSON-Transformations Features zum Aufteilen der **Auditdata** -Spalte in mehrere Spalten.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-163">Here are some tips and examples of exporting and viewing the audit log before and after you use the JSON transform feature to split the **AuditData** column into multiple columns.</span></span>

- <span data-ttu-id="c9e1a-164">Filtern Sie \*\*\*\* die RecordType-Spalte, um nur die Datensätze eines bestimmten Office 365 Diensts oder Funktionsbereichs anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-164">Filter the **RecordType** column to display only the records from a specific Office 365 service or functional area.</span></span> <span data-ttu-id="c9e1a-165">Um beispielsweise Ereignisse im Zusammenhang mit SharePoint-Freigabe anzuzeigen, wählen Sie **14** (enum-Wert für Datensätze, die von SharePoint-freigabeaktivitäten ausgelöst werden) aus.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-165">For example, to show events related to SharePoint sharing, you would select **14** (the enum value for records triggered by SharePoint sharing activities).</span></span> <span data-ttu-id="c9e1a-166">Eine Liste der Office 365 Dienste, die den in der Spalte RecordType angezeigten Enumerationswerten \*\*\*\* entsprechen, finden Sie unter [detaillierte Eigenschaften im Office 365-Überwachungsprotokoll](detailed-properties-in-the-office-365-audit-log.md).</span><span class="sxs-lookup"><span data-stu-id="c9e1a-166">For a list of the Office 365 services that correspond to the enum values displayed in the **RecordType** column, see [Detailed properties in the Office 365 audit log](detailed-properties-in-the-office-365-audit-log.md).</span></span>

- <span data-ttu-id="c9e1a-167">Filtern Sie die Spalte **Vorgänge** , um die Datensätze für bestimmte Aktivitäten anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-167">Filter the **Operations** column to display the records for specific activities.</span></span> <span data-ttu-id="c9e1a-168">Eine Liste der meisten Vorgänge, die einer durchsuchbaren Aktivität im Überwachungsprotokoll-Such Tool im Security #a0 Compliance Center entsprechen, finden Sie im Abschnitt "überwachte Aktivitäten" unter [Durchsuchen des Überwachungsprotokolls im Security #a1 Compliance Center](search-the-audit-log-in-security-and-compliance.md#audited-activities).</span><span class="sxs-lookup"><span data-stu-id="c9e1a-168">For a list of most operations that correspond to a searchable activity in the audit log search tool in the Security & Compliance Center, see the "Audited activities" section in [Search the audit log in the Security & Compliance Center](search-the-audit-log-in-security-and-compliance.md#audited-activities).</span></span>

- <span data-ttu-id="c9e1a-169">Anstatt das Überwachungsprotokoll-Such Tool im Security #a0 Compliance Center zu verwenden, können Sie das Cmdlet [Search-UnifiedAuditLog](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance-audit/search-unifiedauditlog) in Exchange Online PowerShell verwenden, um die Ergebnisse einer Office 365 Überwachungsprotokoll Suche in eine CSV-Datei zu exportieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-169">Instead of using the audit log search tool in the Security & Compliance Center, you can use the [Search-UnifiedAuditLog](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance-audit/search-unifiedauditlog) cmdlet in Exchange Online Powershell to export the results of an Office 365 audit log search to a CSV file.</span></span> <span data-ttu-id="c9e1a-170">Anschließend können Sie das gleiche Verfahren wie in Schritt 2 beschrieben ausführen, um das Überwachungsprotokoll mit dem Power Query-Editor zu formatieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-170">Then you can follow the same procedure described in Step 2 to format the audit log using the Power Query editor.</span></span> <span data-ttu-id="c9e1a-171">Ein Vorteil der Verwendung des PowerShell-Cmdlets besteht darin, dass Sie mithilfe des RecordType-Parameters \*\* nach Ereignissen eines bestimmten Office 365 Diensts suchen können.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-171">One advantage of using the PowerShell cmdlet is that you can search for events from a specific Office 365 service by using the *RecordType* parameter.</span></span> <span data-ttu-id="c9e1a-172">Im folgenden finden Sie einige Beispiele für die Verwendung von PowerShell zum Exportieren von Überwachungsdatensätzen in eine CSV-Datei, damit Sie den Power Query-Editor verwenden können, um das JSON-Objekt in der **Auditdata** -Spalte wie in Schritt 2 beschrieben zu transformieren.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-172">Here are few examples of using PowerShell to export audit records to a CSV file so you can use the Power Query editor to transform the JSON object in the **AuditData** column as described in Step 2.</span></span>

   <span data-ttu-id="c9e1a-173">Führen Sie in diesem Beispiel die folgenden Befehle aus, um alle Datensätze im Zusammenhang mit SharePoint-Freigabe Vorgängen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-173">In this example, run the following commands to return all records related to SharePoint sharing operations.</span></span> 
   
   ```
   $auditlog = Search-UnifiedAuditLog -StartDate 06/01/2019 -EndDate 06/30/2019 -RecordType SharePointSharingOperation
   ```

   ```
   $auditlog | Select-Object -Property CreationDate,UserIds,RecordType,AuditData | Export-Csv -Path c:\AuditLogs\PowerShellAuditlog.csv -NoTypeInformation
   ```

   - <span data-ttu-id="c9e1a-174">Die Suchergebnisse werden in eine CSV-Datei mit dem Namen *PowerShellAuditlog* exportiert, die vier Spalten enthält: CreationDate, userids, RecordType, Auditdata).</span><span class="sxs-lookup"><span data-stu-id="c9e1a-174">The search results are exported to a CSV file named *PowerShellAuditlog* that contains four columns: CreationDate, UserIds, RecordType, AuditData).</span></span>

   - <span data-ttu-id="c9e1a-175">Sie können den Namen oder den enum-Wert für den Record-Typ als Wert für \*\* den RecordType-Parameter verwenden.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-175">You can use the name or enum value for the record type as the value for the *RecordType* parameter.</span></span> <span data-ttu-id="c9e1a-176">Eine Liste der Namen von Datensatztypen und der zugehörigen Enumerationswerte finden Sie in der *AuditLogRecordType* -Tabelle in [Office 365 API-Schema der Verwaltungsaktivität](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#enum-auditlogrecordtype---type-edmint32).</span><span class="sxs-lookup"><span data-stu-id="c9e1a-176">For a list of record type names and their corresponding enum values, see the *AuditLogRecordType* table in [Office 365 Management Activity API schema](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#enum-auditlogrecordtype---type-edmint32).</span></span>
   
   - <span data-ttu-id="c9e1a-177">Sie können nur einen einzelnen Wert für diesen Parameter einschließen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-177">You can only include a single value for this parameter.</span></span> <span data-ttu-id="c9e1a-178">Um nach Überwachungsdatensätzen für andere Datensatztypen zu suchen, müssen Sie die beiden vorherigen Befehle erneut ausführen, um einen anderen Datensatztyp anzugeben und diese Ergebnisse an die ursprüngliche CSV-Datei anzufügen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-178">To search for audit records for other record types, you have to run the two previous commands again to specify a different record type and append those results to the original CSV file.</span></span> <span data-ttu-id="c9e1a-179">Beispielsweise würden Sie diese beiden Befehle ausführen, um SharePoint-Dateiaktivitäten aus dem gleichen Datumsbereich zur PowerShellAuditlog. CSV-Datei hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c9e1a-179">For example, you would run these two commands to add SharePoint file activities from the same date range to the PowerShellAuditlog.csv file.</span></span>

       ```
      $auditlog = Search-UnifiedAuditLog -StartDate 06/01/2019 -EndDate 06/30/2019 -RecordType SharePointFileOperation
      ```

      ```
      $auditlog | Select-Object -Property CreationDate,UserIds,RecordType,AuditData | Export-Csv -Append -Path c:\AuditLogs\PowerShellAuditlog.csv -NoTypeInformation
      ```
